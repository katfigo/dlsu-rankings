import React, { useEffect, useState } from "react";
import { Card, CardContent } from "@/components/ui/card";
import { Input } from "@/components/ui/input";
import { motion } from "framer-motion";
import Image from "next/image";

const HEADER_IMAGE = "/IMG_8053-2.jpg";

const studentsData = [
  {
    name: "Rafael Gorgon Batungbakal",
    gpa: 4.0,
    activities: 18,
    awards: 53,
    score: 95,
  },
  {
    name: "Ashiyanna Maria Hernandez Sotto",
    gpa: 4.0,
    activities: 13,
    awards: 43,
    score: 90,
  },
  {
    name: "Kirsten Xyra Bayer Figueroa",
    gpa: 4.0,
    activities: 10,
    awards: 37,
    score: 85,
  },
  {
    name: "Thrystan Xylon Apelo Usi",
    gpa: 3.0,
    activities: 4,
    awards: 14,
    score: 72,
  },
  // Fill in 241+ random students
  ...Array.from({ length: 242 }, (_, i) => {
    const name = `Student ${i + 5} ${String.fromCharCode(65 + (i % 26))}`;
    const gpa = (Math.random() * 1 + 3).toFixed(2);
    const activities = Math.floor(Math.random() * 10);
    const awards = Math.floor(Math.random() * 30);
    const score = parseFloat(gpa) * 20 + activities + awards;
    return { name, gpa, activities, awards, score };
  })
];

export default function Leaderboard() {
  const [students, setStudents] = useState([]);

  useEffect(() => {
    // Simulate dynamic changes: Move Kirsten down and up
    let moving = [...studentsData];
    const update = () => {
      moving = [...studentsData];
      const time = Date.now();
      if ((Math.floor(time / 10000) % 2) === 0) {
        // Move Kirsten to 10th
        const idx = moving.findIndex(s => s.name.includes("Kirsten"));
        if (idx !== -1) {
          const removed = moving.splice(idx, 1)[0];
          moving.splice(9, 0, removed);
        }
      }
      setStudents([...moving].sort((a, b) => b.score - a.score));
    };
    update();
    const interval = setInterval(update, 5000);
    return () => clearInterval(interval);
  }, []);

  return (
    <div className="min-h-screen bg-green-50 text-green-900 p-4">
      <div className="w-full h-48 relative mb-6">
        <Image src={HEADER_IMAGE} alt="Header" fill className="object-contain" />
      </div>
      <h1 className="text-3xl font-bold text-center mb-4">De La Salle University Student Leaderboard</h1>
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {students.map((student, index) => (
          <motion.div
            key={student.name}
            initial={{ opacity: 0, y: 10 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.3, delay: index * 0.01 }}
          >
            <Card className={`rounded-2xl shadow-md p-4 ${index < 3 ? 'bg-green-200' : 'bg-white'}`}>
              <CardContent>
                <h2 className="text-xl font-semibold">#{index + 1} {student.name}</h2>
                <p>GPA: {student.gpa}</p>
                <p>Extra Curricular Activities: {student.activities}</p>
                <p>Awards: {student.awards}</p>
                <p className="font-bold">Score: {student.score.toFixed(2)}</p>
              </CardContent>
            </Card>
          </motion.div>
        ))}
      </div>
    </div>
  );
}
